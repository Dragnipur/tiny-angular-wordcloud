angular.module("tangcloud",[]).directive("tangCloud",["$interpolate","$compile","$timeout",function(a,b,c){var d={restrict:"E",scope:{width:"=",height:"=",words:"=",onClick:"&",spin:"="},template:function(a,b){var c=angular.isDefined(b.onClick),d=c?'ng-click="onClick({word : entry.word, id : entry.id})"':"";return"<div class='tangcloud'><span ng-repeat='entry in words'"+d+">{{entry.word}}</span></div>"},compile:function(b){return b.children().children().addClass("tangcloud-item-"+a.startSymbol()+"entry.size"+a.endSymbol()),function(a,b){function d(a){for(var b=a.length-1;b>0;b--){var c=Math.floor(Math.random()*(b+1)),d=a[b];a[b]=a[c],a[c]=d}return a}function e(){c(function(){for(var a=b.children().eq(0).children(),c=a.length,d=0;c>d;d++)f(a.eq(d))})}function f(a){for(var b=parseInt(window.getComputedStyle(a[0]).lineHeight,10),c=a[0].offsetWidth,d={startX:k-c/2,startY:l-b/2,endX:k+c/2,endY:l+b/2},e=0;g(d);){var f=.1*e;d.startX=k+1.5*f*Math.cos(f)-c/2,d.startY=l+f*Math.sin(f)-b/2,d.endX=d.startX+c,d.endY=d.startY+b,e+=1}m.push(d),j(a,d.startX,d.startY)}function g(b){for(var c={left:k-a.width/2,right:k+a.width/2,bottom:l-a.height/2,top:l+a.height/2},d=0;d<m.length;d++)if(h(b,c)||i(b,m[d]))return!0;return!1}function h(a,b){return a.startX<b.left||a.endX>b.right||a.startY<b.bottom||a.endY>b.top}function i(a,b){return a.startX>b.endX||a.endX<b.startX?!1:!(a.startY>b.endY||a.endY<b.startY)}function j(a,b,c){var d="position: absolute; left:"+b+"; top: "+c;a.attr("style",d)}var k=a.width/2,l=a.height/2,m=[];a.words=d(a.words),e()}}};return d}]);