angular.module("tangcloud",[]).directive("tangCloud",["$interpolate","$compile","$timeout",function(a,b,c){var d={restrict:"E",scope:{width:"=",height:"=",words:"=",onClick:"&",spin:"="},template:function(a,b){var c=angular.isDefined(b.onClick),d=c?'ng-click="onClick({word : entry.word, id : entry.id})"':"";return"<div class='tangcloud'><span ng-repeat='entry in words'"+d+">{{entry.word}}</span></div>"},compile:function(b){return b.children().children().addClass("tangcloud-item-"+a.startSymbol()+"entry.size"+a.endSymbol()).addClass("tangcloud-item-hidden"),function(a,b){function d(a){for(var b=a.length-1;b>0;b--){var c=Math.floor(Math.random()*(b+1)),d=a[b];a[b]=a[c],a[c]=d}return a}function e(){c(function(){for(var a=b.children().eq(0).children(),c=a.length,d=0;c>d;d++)f(a.eq(d))})}function f(a){for(var b=parseInt(window.getComputedStyle(a[0]).lineHeight,10),c=a[0].offsetWidth,d=g(c,b),e=0;i(d)&&50>o;)d=h(d,e),e+=1;50>o&&(p.push(d),l(a,d.startX,d.startY)),o=0}function g(a,b){return{width:a,height:b,startX:m-a/2,startY:n-b/2,endX:m+a/2,endY:n+b/2}}function h(a,b){var c=.1*b;return a.startX=m+1.5*c*Math.cos(c)-a.width/2,a.startY=n+c*Math.sin(c)-a.height/2,a.endX=a.startX+a.width,a.endY=a.startY+a.height,a}function i(b){for(var c={left:m-a.width/2,right:m+a.width/2,bottom:n-a.height/2,top:n+a.height/2},d=0;d<p.length;d++)if(j(b,c)||k(b,p[d]))return!0;return!1}function j(a,b){return a.startX<b.left||a.endX>b.right||a.startY<b.bottom||a.endY>b.top?(o++,!0):!1}function k(a,b){return a.startX>b.endX||a.endX<b.startX?!1:!(a.startY>b.endY||a.endY<b.startY)}function l(a,b,c){var d="position: absolute; left:"+b+"px; top: "+c+"px;";a.attr("style",d),a.removeClass("tangcloud-item-hidden")}var m=a.width/2,n=a.height/2,o=0,p=[];a.words=d(a.words),e()}}};return d}]);